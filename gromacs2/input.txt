# Step 1: Preprocessing the structure
gmx pdb2gmx -f collagen.pdb -o processed.gro -p topology.top


#The Gromos54a7 force field is used.

# Step 2: Defining the box
gmx editconf -f processed.gro -o newbox.gro -c -d 10 -bt cubic

gmx grompp -f minim.mdp -r newbox.gro -c newbox.gro -p topology.top -o em.tpr -maxwarn 2

# Step 4: Energy minimization run
gmx mdrun -v -deffnm em

# Step 5: Generating index file
gmx make_ndx -f processed.gro -o index.ndx
# fix 181-188 369-376 557-564
# pull 1-9 189-197 377-385

# Step 6: NVT equilibration setup
gmx grompp -f nvt.mdp -r em.gro -c em.gro -p topology.top -n index.ndx -o nvt.tpr -maxwarn 2

# Step 7: NVT equilibration run
gmx mdrun -deffnm nvt

# Step 8: Production MD setup
gmx grompp -f md.mdp -r nvt.gro -c nvt.gro -p topology.top -n index.ndx -o md_0_1.tpr -maxwarn 2

# Step 9: Production MD run
gmx mdrun -deffnm md_0_1

gmx trjconv -s topol.tpr -o traj.pdb